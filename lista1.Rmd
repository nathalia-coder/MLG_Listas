---
title: "Resolução Lista I"
author: "Nathalia Gabriella Ferreira dos Santos"
date: "`r Sys.Date()`"
output: pdf_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Pacotes

```{r message=TRUE, warning=TRUE}
library(tidyverse)
```

# Questão 1

**Enunciado:**

Considere o conjunto de dados abaixo referente a um valor mínimo pago de seguros individuais
(em dólares americanos) por danos com acidentes pessoais. Além do valor pago ao segurado,
serão consideradas as seguintes variáveis explicativas: 

* *legrep:* representação legal (não ou sim)

* *optime:* tempo operacional (em horas) para pagamento do seguro.

```{r}
rm(list = ls())

df <- data.frame(
  valor = c(9.17,6.79,16.64,8.81,15.86,10.07,12.69,6.91,5.43,10.88,8.37,11.9,16.12,8.74,9.35),
  legrep = c("nao","nao","nao","nao","sim","nao","sim","nao","nao","sim","nao","sim","sim","nao","nao"),
  optime = c(18.2,13.1,32.9,17.4,29.5,19.5,22.7,13.3,10.5,19.6,16.3,21.2,29.7,17,18.3)
) %>% as_tibble()

df
```

**a)**

```{r}
x <- df %>% select(legrep, optime) %>% 
  mutate(aux = 1) %>% 
  pivot_wider(names_from = legrep,
              names_prefix = "legrep_",
              values_from = aux,
              values_fill = 0)
  
x
```

**b)**

```{r}
# ambas formas dao o mesmo
fit_teste <- lm(formula = df$valor ~ legrep + optime, data = x)

fit <- lm(formula = valor ~ legrep + optime, data = df)
```

```{r}
resposta = fit %>% coefficients() %>% cbind()
colnames(resposta) <- "Coeficientes"
row.names(resposta) <- c("b0","b1","b2")
resposta
```

**c)**

Sim, todas variáveis explicativas são significativas pois $p-valor < \alpha = 0,05$ para todo p-valor encontrado. 

```{r}
resumo <- summary(fit)
resumo$coefficients[,4]
```

**d)**

```{r}
fit %>% fitted()
```

**e)**

Sobre a hipótese nula de que os dados seguem distribuição normal contra a hipótese alternativa que os dados não seguem distribuição normal, dado um $p-valor > \alpha = 0,05$, não rejeita-se $H_0$, logo, há evidências que os resíduos seguem distribuição normal.

```{r}
fit %>% residuals() %>% shapiro.test()
```

**f)**

```{r}
X <- x %>% as.matrix()
t(X) %*% X %>% # transposta * matriz normal
  solve()      # inversa da matriz

```

**g)**

```{r}
r2_adj <- resumo$adj.r.squared
```


Dado um $R^2 = $ `r r2_adj * 100 %>% round(2)`, conclui-se que o modelo ficou muito bem ajustado para esse conjunto de dados.


